<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle{stroke: black;} </style>
<body onload='init()'>

<button class = "button" id = "2015">2015</button>
<button class = "button" id = "2016">2016</button>
<button class = "button" id = "2017">2017</button>
<button class = "button" id = "2018">2018</button>
<button class = "button" id = "2019">2019</button>

<svg width=900 height=900>
</svg>
<script>

async function init() {
const data2015 = await d3.csv('https://raw.githubusercontent.com/hughhhuang/hughhhuang.github.io/main/world_happiness_data/2015.csv');
const data2016 = await d3.csv('https://raw.githubusercontent.com/hughhhuang/hughhhuang.github.io/main/world_happiness_data/2016.csv');
const data2017 = await d3.csv('https://raw.githubusercontent.com/hughhhuang/hughhhuang.github.io/main/world_happiness_data/2017.csv');
const data2018 = await d3.csv('https://raw.githubusercontent.com/hughhhuang/hughhhuang.github.io/main/world_happiness_data/2018.csv');
const data2019 = await d3.csv('https://raw.githubusercontent.com/hughhhuang/hughhhuang.github.io/main/world_happiness_data/2019.csv');

var margin = {top: 200, right: 30, bottom: 30, left: 60},
    width = 550,
    height = 550;


var svg = d3.select("svg")

const regions = ['Western Europe', 'North America', 'Australia and New Zealand', 'Middle East and Northern Africa', 'Latin America and Caribbean', 'Southeastern Asia', 'Central and Eastern Europe','Eastern Asia', 'Sub-Saharan Africa']

var x = d3.scaleLinear().domain([0,2.2]).range([0,550]) 
var y = d3.scaleLinear().domain([0,10]).range([550,0])
var pcol = d3.scaleOrdinal().domain(regions)
    .range(d3.schemeCategory10)


svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2015)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['Economy (GDP per Capita)']); } )
      .attr("cy", function (d) { return y(+d['Happiness Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })



svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

svg.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "middle")
    .attr("y", 6)
    .attr("x", -(height / 2))
    .attr("dy", ".75em")
    .attr("transform", "rotate(-90)")
    .text("Happiness Score");

svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

//x-axis label
svg.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "middle")
    .attr("x", (width/2) + margin.left)
    .attr("y", height + margin.top + 50)
    .text("GDP per capita");


//legend dots
svg.selectAll("dots")
    .data(regions)
    .enter()
    .append("circle")
        .attr("cx", width + margin.left + margin.right + 10)
        .attr("cy", function(d,i) {return margin.top + i*25})
        .attr("r", 10)
        .style("fill", function(d,i){ return pcol(regions[i])})

//legend text
svg.selectAll("myLabels")
    .data(regions)
    .enter()
    .append("text")
        .attr("text-anchor", "left")
        .attr("x", width + margin.left + margin.right + 30)
        .attr("y", function(d,i) {return margin.top + i*25})
        .text(function(d){ return d})
        .attr("fill", function(d,i){ return pcol(regions[i])})
        .style("alignment-baseline", "middle")


document.getElementById("2015").onclick = function() {disp2015()};

function disp2015() {
    svg.selectAll("circle").remove()
    
    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

    svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2015)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['Economy (GDP per Capita)']); } )
      .attr("cy", function (d) { return y(+d['Happiness Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })
}

document.getElementById("2016").onclick = function() {disp2016()};

function disp2016() {
    svg.selectAll("circle").remove()
    
    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

    svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2016)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['Economy (GDP per Capita)']); } )
      .attr("cy", function (d) { return y(+d['Happiness Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })
}

document.getElementById("2017").onclick = function() {disp2017()};

function disp2017() {
    svg.selectAll("circle").remove()
    
    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

    svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2017)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['Economy..GDP.per.Capita.']); } )
      .attr("cy", function (d) { return y(+d['Happiness.Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })
}

document.getElementById("2018").onclick = function() {disp2018()};

function disp2018() {
    svg.selectAll("circle").remove()
    
    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

    svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2018)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['GDP per capita']); } )
      .attr("cy", function (d) { return y(+d['Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })
}

document.getElementById("2019").onclick = function() {disp2019()};

function disp2019() {
    svg.selectAll("circle").remove()
    
    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")") 
    .call(d3.axisBottom(x));

    svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .call(d3.axisLeft(y));

    svg.append("g").attr("transform","translate(" + margin.left + "," + margin.top + ")").selectAll("circle")
    .data(data2019)
    .enter()
    .append("circle")
      .attr("cx", function (d) { return x(+d['GDP per capita']); } )
      .attr("cy", function (d) { return y(+d['Score']); } )
      .attr("r", 10)
      .attr("fill", function (d) { return pcol(d.Region); })
}


}



</script>
</body>
</html>